# 大麥蟲智能養殖監控系統

一個基於 Web 的大麥蟲養殖環境遠端監控與控制系統,採用 iOS 風格設計,提供清新整潔的使用者介面。

## 🎯 特色亮點

- ✨ **單頁面設計** - 所有資訊一目了然,無需滾動
- 📱 **兩欄佈局** - 左側監測與控制,右側參數設定
- 🎨 **iOS 風格** - 清新簡潔的 Apple 設計語言
- ⚡ **即時更新** - MQTT 即時通訊,延遲極低
- 🔧 **完整控制** - 遠端修改所有參數

## 功能特色

### 📊 即時監測
- **環境溫度** - 來自 AHT25 感測器
- **環境濕度** - 來自 AHT25 感測器
- **基質溫度** - 來自 NTC 10K 熱敏電阻
- **運作模式** - 自動/手動模式顯示

### 🎛️ 設備控制
- **加熱器控制** - 開啟/關閉/自動模式
- **噴霧器控制** - 開啟/關閉/自動模式
- **餵食器控制** - 立即觸發餵食

### ⚙️ 參數設定
所有參數可透過網頁介面遠端修改:

#### 溫度控制
- 加熱器啟動溫度 (預設: 25.5°C)
- 加熱器關閉溫度 (預設: 28.5°C)
- 加熱安全停機溫度 (預設: 32.0°C)

#### 濕度控制
- 噴霧啟動濕度 (預設: 60%RH)
- 噴霧關閉濕度 (預設: 68%RH)
- 噴霧最大連續開啟時間 (預設: 60秒)
- 噴霧最小關閉時間 (預設: 600秒)

#### 餵食設定
- 餵食最小間隔時間 (預設: 6小時)
- 伺服馬達運轉時間 (預設: 3000ms)
- 餵食時間排程 (格式: 09:00,17:00)

#### 系統設定
- Google Sheets 上傳間隔 (預設: 30分鐘)
- 運作模式 (自動/手動)

### 📝 事件日誌
即時顯示系統事件、警告和操作記錄

## 技術架構

### 前端技術
- **HTML5** - 語義化標記
- **CSS3** - iOS 風格設計,響應式佈局
- **JavaScript (ES6+)** - 互動邏輯
- **MQTT.js** - MQTT 通訊協定支援

### 通訊協定
- **MQTT over WebSocket** - 即時雙向通訊
- 支援標準 MQTT broker (如 HiveMQ, Mosquitto 等)

### MQTT Topics 結構
```
farm/telemetry/<DEVICE_ID>        # 遙測數據 (每秒)
farm/control/<DEVICE_ID>/heater   # 加熱器控制
farm/control/<DEVICE_ID>/mist     # 噴霧器控制
farm/control/<DEVICE_ID>/feed     # 餵食器控制
farm/config/<DEVICE_ID>           # 設定輸入
farm/config/<DEVICE_ID>/current   # 目前設定
farm/status/<DEVICE_ID>           # 狀態更新
farm/command/<DEVICE_ID>          # 系統指令
```

## 使用方式

### 1. 開啟網頁
直接在瀏覽器中開啟 `index.html` 檔案

### 2. 設定連接
- 輸入裝置 ID (例如: barleybox-001)
- 輸入 MQTT Broker 地址
- 點擊「連接裝置」按鈕

### 3. 監控數據
連接成功後,即可看到即時的環境數據和設備狀態

### 4. 控制設備
- 使用設備狀態區的按鈕控制加熱器、噴霧器
- 點擊「立即餵食」觸發餵食動作

### 5. 修改參數
- 切換到不同的參數設定標籤
- 修改所需參數
- 點擊「儲存並套用設定」

## MQTT Broker 設定

### 使用公開 Broker (測試用)
```
Broker: broker.hivemq.com
WebSocket Port: 8000
```

### 使用自架 Mosquitto
需要啟用 WebSocket 支援,在 `mosquitto.conf` 中添加:
```
listener 8083
protocol websockets
```

## 瀏覽器相容性

- ✅ Chrome 90+
- ✅ Firefox 88+
- ✅ Safari 14+
- ✅ Edge 90+

## 設計特色

### iOS 風格
- 採用 Apple 設計語言
- 圓角卡片設計
- 柔和的陰影效果
- 流暢的動畫過渡

### 響應式設計
- 支援桌面、平板、手機
- 自適應網格佈局
- 觸控友善的按鈕尺寸

### 視覺元素
- SVG 圖標設計
- 清晰的資訊層級
- 直覺的色彩系統

## 資料持久化

系統會自動將以下資料儲存在瀏覽器本地:
- 裝置 ID
- MQTT Broker 地址
- 最後設定的參數

## 安全建議

1. 使用 WSS (WebSocket Secure) 連接
2. 設定 MQTT 使用者認證
3. 限制 MQTT topic 存取權限
4. 定期更新裝置韌體

## 故障排除

### 無法連接 MQTT
- 檢查 Broker 地址是否正確
- 確認 WebSocket 端口已開啟
- 檢查防火牆設定

### 收不到資料
- 確認裝置 ID 正確
- 檢查裝置是否在線
- 查看瀏覽器控制台錯誤訊息

### 參數設定無效
- 確認已點擊「儲存並套用設定」
- 檢查裝置是否收到設定訊息
- 重新連接裝置

## 未來規劃

- [ ] 歷史數據圖表顯示
- [ ] 警報通知系統
- [ ] 多裝置管理
- [ ] 使用者權限管理
- [ ] 資料匯出功能
- [ ] 行動裝置 App

## 授權

本專案僅供學習和個人使用

## 聯絡方式

如有問題或建議,歡迎提出 Issue

---

**大麥蟲智能養殖監控系統** - 讓養殖更智能,管理更輕鬆 🐛

